FROM vm/ubuntu:22.04

# Añadir NodeSource para Node.js 20.x y actualizar el sistema
RUN curl -fSsL https://deb.nodesource.com/setup_20.x | bash && \
    apt-get install -y nodejs python3 make gcc build-essential

# node es un consumidor intensivo de memoria
MEMORY 5G
ENV NODE_OPTIONS=--max-old-space-size=8192

COPY . .
RUN npm install
RUN npm run build
RUN BACKGROUND npm run start

# Crear un enlace único para compartir la aplicación en este corredor.
# Cada vez que alguien haga clic en el enlace, despertará este servidor de staging.
EXPOSE WEBSITE http://localhost:3000
